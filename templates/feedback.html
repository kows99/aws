{% extends "base.html" %}
{% block title %}Rate {{ movie.title }} - CinemaPulse{% endblock %}
{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <h1 class="gradient-title">{{ movie.title }}</h1>
    <p style="color: #9ca3af; margin-bottom: 2rem;">{{ movie.genre }} • Rate your experience</p>
    
    <form method="POST">  <!-- ✅ NO ACTION NEEDED -->
        <input type="hidden" name="movie_title" value="{{ movie.title }}">
        
        <div class="card" style="margin-bottom: 2rem;">
            <label style="font-weight: 800; margin-bottom: 1rem; display: block; color: var(--red);">⭐ Your Rating</label>
            <div class="stars" style="margin-bottom: 1rem;">
                <span data-rating="1">★</span>
                <span data-rating="2">★</span>
                <span data-rating="3">★</span>
                <span data-rating="4">★</span>
                <span data-rating="5">★</span>
            </div>
            <select name="rating" id="rating" required style="display: none;">
                <option value="">Select rating</option>
                {% for i in range(1, 6) %}
                <option value="{{ i }}">{{ i }} Star{{ 's' if i > 1 else '' }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="card">
            <label style="font-weight: 600; margin-bottom: 1rem; display: block; color: var(--red);">Your Feedback</label>
            <textarea name="review" rows="6" placeholder="What did you think about the movie? Be honest!" required></textarea>
            <button type="submit" class="btn" style="width: 100%; margin-top: 1.5rem; font-size: 1.1rem;">Submit Feedback →</button>
        </div>
    </form>
</div>

<script>
document.querySelectorAll('.stars span').forEach(star => {
    star.addEventListener('click', function() {
        const rating = this.dataset.rating;
        document.getElementById('rating').value = rating;
        document.querySelectorAll('.stars span').forEach(s => {
            s.style.color = s.dataset.rating <= rating ? '#fbbf24' : '#9ca3af';  <!-- ✅ FIXED -->
        });
    });
});
</script>

<style>
.stars span { 
    font-size: 2.5rem; cursor: pointer; transition: all 0.3s; margin: 0 3px; color: #9ca3af;
}
.stars span:hover { transform: scale(1.2); }
</style>
{% endblock %}
